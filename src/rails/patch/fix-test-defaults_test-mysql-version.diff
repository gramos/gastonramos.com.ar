From 3ea59cc3b3ceeae6a335830b330855cc9586c00a Mon Sep 17 00:00:00 2001
From: Gaston Ramos <ramos.gaston@gmail.com>
Date: Mon, 10 Nov 2008 16:24:46 -0200
Subject: [PATCH] Fix Mysql.client_version limit for 40111 version.

---
 activerecord/test/cases/defaults_test.rb |   10 ++++++----
 1 files changed, 6 insertions(+), 4 deletions(-)

diff --git a/activerecord/test/cases/defaults_test.rb b/activerecord/test/cases/defaults_test.rb
index ee84cb8..d254639 100644
--- a/activerecord/test/cases/defaults_test.rb
+++ b/activerecord/test/cases/defaults_test.rb
@@ -3,9 +3,10 @@ require 'models/default'
 require 'models/entrant'
 
 class DefaultTest < ActiveRecord::TestCase
+
   def test_nil_defaults_for_not_null_columns
     column_defaults =
-      if current_adapter?(:MysqlAdapter) && (Mysql.client_version < 50051 || (50100..50122).include?(Mysql.client_version))
+      if current_adapter?(:MysqlAdapter) && (Mysql.client_version < 40111 || (50100..50122).include?(Mysql.client_version))
         { 'id' => nil, 'name' => '',  'course_id' => nil }
       else
         { 'id' => nil, 'name' => nil, 'course_id' => nil }
@@ -20,9 +21,10 @@ class DefaultTest < ActiveRecord::TestCase
 
   if current_adapter?(:MysqlAdapter)
 
-    #MySQL 5 and higher is quirky with not null text/blob columns.
-    #With MySQL Text/blob columns cannot have defaults. If the column is not null MySQL will report that the column has a null default
-    #but it behaves as though the column had a default of ''
+    # MySQL 5 and higher is quirky with not null text/blob columns.
+    # With MySQL Text/blob columns cannot have defaults. If the column is
+    # not null MySQL will report that the column has a null default
+    # but it behaves as though the column had a default of ''
     def test_mysql_text_not_null_defaults
       klass = Class.new(ActiveRecord::Base)
       klass.table_name = 'test_mysql_text_not_null_defaults'
-- 
1.5.6.5

